<app-header-personal></app-header-personal>

<div class="content-container">

  <div *ngIf="isLoading" class="loading">
    <p>Carregando informações do personal...</p>
  </div>

  <div *ngIf="hasError && !isLoading" class="error">
    <p>Não foi possível carregar os dados do personal. Tente novamente mais tarde.</p>
  </div>

  <div class="detalhes-container" *ngIf="!isLoading && !hasError && personal">
    <h2>{{ personal.nome }}</h2>
    <div class="personal-visual">
      <img [src]="personal.imagem" alt="{{ personal.nome }}" class="personal-img" />
      <p class="agrupamento">
        Especialidade <br />
        <span>{{ personal.especialidade | titlecase }}</span>
      </p>
    </div>

    <div class="descricao">
      <h1>Informações do Personal:</h1>
      <p><strong>Nome:</strong></p>
      <p>{{ personal.nome }}</p>
      <p><strong>Especialidade:</strong></p>
      <p>{{ personal.especialidade }}</p>
      <p><strong>Descrição:</strong></p>
      <p>{{ personal.descricao }}</p>
      <p><strong>Rede Social:</strong></p>
      <p>{{ personal.redeSocial }}</p>
    </div>

    <!-- ✅ Formulário de mensagens (apenas para usuário comum logado) -->
    <div class="mensagem-container" *ngIf="usuarioLogado && usuarioLogado.perfil?.toLowerCase() === 'comum'">
      <h3>Entre em contato com {{ personal.nome }}</h3>
      <textarea [(ngModel)]="mensagem" placeholder="Escreva sua mensagem..." rows="4"></textarea>
      <button (click)="enviarMensagem()" class="btn-enviar">Enviar mensagem</button>

      <!-- Feedback -->
      <p class="sucesso" *ngIf="mensagemEnviada">✅ Mensagem enviada com sucesso!</p>
      <p class="erro" *ngIf="erroMensagem">❌ Erro ao enviar mensagem. Tente novamente.</p>
    </div>

    <!-- Caso não esteja logado ou não seja Comum -->
    <div *ngIf="!usuarioLogado || usuarioLogado.perfil?.toLowerCase() !== 'comum'" class="mensagem-bloqueada">
      <p>⚠️ Apenas usuários comuns logados podem enviar mensagens para um personal.</p>
    </div>
  </div>
</div>

<app-footer></app-footer>
